# Malware-analysis
I am currently working through TCM Security Practical Malware Analysis & Triage by Matt aka HuskyHacks. This is the first lab. I will be conducting basic static & dynamic analysis. The malware I am working with is Malware.Unknown.exe.malz.

I will start of by getting the Hash values. There is multiple ways you can get the Hash of the file. I will let you choose which way you want to get the hash.

Hash:

    SHA256- 92730427321a1c4ccfc0d0580834daef98121efa9bb8963da332bfd6cf1fda8a

    MD5Sum- 1d8562c0adcaee734d63f7baaca02f7c

BASIC STATIC ANAlYSIS

I will now use the tool Floss, to help assist me in pulling out important strings. You will input this inot the command prompt "floss Malware.Unknown.exe.malz".This will help us in our dynamic search. The following output is below:

    jjjj 
    cmd.exe /C ping 1.1.1.1 -n 1 -w 3000 > Nul & Del /f /q "%s" 
    http://ssl-6582datamanager.helpdeskbros.local/favicon.ico 
    C:\Users\Public\Documents\CR433101.dat.exe 
    Mozilla/5.0 
    ping 1.1.1.1 -n 1 -w 3000 > Nul & C:\Users\Public\Documents\CR433101.dat.exe open


BASIC DYNAMIC ANALYSIS

I will start by detontating the malware in our sandbox without internet connection to see what happens. 
      
      When the malware was detonated without having an internet connection the malware deletes from the desktop. 
      I have a hypothesis when the malware cannot make a connection it will delete itself.

I will now detonate the malware with internet connection, this will help me find network and host based indicators. I will start off with the network signatures.

NETWORK SIGNATURE

I started off by making sure my INetSim is up and running. INetSim is a software used for simulating common internet services in lab environment. I also set-up wireshark to capture any connection.
Now that we have a internet connection I will detonate the malware to see what happens. I used the HTTP string we found earlier in our static analysis using floss and searched for it see image below.

Insert picture


You will see the get requet for favicon.io. This matches up with what we found in our static analysis.


HOST BASED INDICATORS

    insert picture


    Once favicon is requested and a connection is made the file CR433101.dat.exe is written to the file system

    C:\Users\Public\Documents\CR433101.dat.exe we got this by using procmon. Procmon allows us to see how malware interacts with a system and identify malicious activities.


Program Execution Flow:

    If URL exist:
    Download favicon.io
    Writes to disk:CR433101.dat.exe
    Run favicon.ico:CR433101.dat.exe
    
    If URL doesnâ€™t exit:
    Delete from disk
    Do not run








![Alt Text](https://github.com/JamahdPerry99/JamahdPerry99/blob/main/Screenshot_20221029_032805.png?raw=true)
